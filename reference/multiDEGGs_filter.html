<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-gb"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>multiDEGGs_filter — multiDEGGs_filter • multiDEGGs</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="multiDEGGs_filter — multiDEGGs_filter"><meta name="description" content="Function to be passed to the modifyX parameter of
nestcv.train or nestcv.glmnet to allow
nested feature selection and augmentation via differential network analysis
with multiDEGGs."><meta property="og:description" content="Function to be passed to the modifyX parameter of
nestcv.train or nestcv.glmnet to allow
nested feature selection and augmentation via differential network analysis
with multiDEGGs."><meta property="og:image" content="https://elisabettasciacca.github.io/multiDEGGs/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">multiDEGGs</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/multiDEGGs_vignette.html">Differential Network Analysis with multiDEGGs</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/elisabettasciacca/multiDEGGs/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>multiDEGGs_filter</h1>
      <small class="dont-index">Source: <a href="https://github.com/elisabettasciacca/multiDEGGs/blob/main/R/feature_selection_for_ML.R" class="external-link"><code>R/feature_selection_for_ML.R</code></a></small>
      <div class="d-none name"><code>multiDEGGs_filter.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Function to be passed to the <code>modifyX</code> parameter of
<a href="https://rdrr.io/pkg/nestedcv/man/nestcv.train.html" class="external-link">nestcv.train</a> or <a href="https://rdrr.io/pkg/nestedcv/man/nestcv.glmnet.html" class="external-link">nestcv.glmnet</a> to allow
nested feature selection and augmentation via differential network analysis
with multiDEGGs.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">multiDEGGs_filter</span><span class="op">(</span><span class="va">y</span>, <span class="va">x</span>, keep_single_genes <span class="op">=</span> <span class="cn">FALSE</span>, nfilter <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-y">y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>Numeric vector or factor. Response variable (outcome), i.e.
the 'metadata' named vector, as passed by <a href="https://rdrr.io/pkg/nestedcv/man/nestcv.train.html" class="external-link">nestcv.train</a> or
<a href="https://rdrr.io/pkg/nestedcv/man/nestcv.glmnet.html" class="external-link">nestcv.glmnet</a>.</p></dd>


<dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>Predictor variables, i.e. the assayData matrix with genes in columns
and IDs in rows, as passed by <a href="https://rdrr.io/pkg/nestedcv/man/nestcv.train.html" class="external-link">nestcv.train</a> or
<a href="https://rdrr.io/pkg/nestedcv/man/nestcv.glmnet.html" class="external-link">nestcv.glmnet</a>.</p></dd>


<dt id="arg-keep-single-genes">keep_single_genes<a class="anchor" aria-label="anchor" href="#arg-keep-single-genes"></a></dt>
<dd><p>Logical, default FALSE. If TRUE, the function will
return unique individual genes along with significant pairs.</p></dd>


<dt id="arg-nfilter">nfilter<a class="anchor" aria-label="anchor" href="#arg-nfilter"></a></dt>
<dd><p>Integer. Maximum total number of predictors to return.
When <code>keep_single_genes = TRUE</code>, this parameter limits the combined count of
unique and paired predictors
(i.e., length(keep_DEGGs) + nrow(pairs) &lt;= nfilter).
Predictors are included from most to least significant: for each pair, both
the pair itself and the new unique variables are included until the <code>nfilter</code>
threshold is reached.
When <code>keep_single_genes = FALSE</code>, <code>nfilter</code> only limits the number of pairs
returned.
If <code>NULL</code>, no filtering is applied and the total number of predictors
will depend on how many significantly different interactions are detected by
multiDEGGs in that fold.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>a list containing two types of predictors:</p><ul><li><p>single predictors (stored in the 'keep_DEGGs' vector)</p></li>
<li><p>paired predictors (stored in the 'pairs' dataframe)
Note that <code>nfilter</code> limits the maximum number of engineered features returned,
however this number might be lower and will depend on how many significantly
different interactions will be found in each fold by multiDEGGs.
<b>If no significantly different interactions are found
the function will print a '0' and switch to t-test for that fold.</b></p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/myles-lewis/nestedcv" class="external-link">nestedcv</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"synthetic_metadata"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"synthetic_rnaseqData"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># fit a regularized linear model:</span></span></span>
<span class="r-in"><span><span class="va">fit.glmnet</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/nestedcv/man/nestcv.glmnet.html" class="external-link">nestcv.glmnet</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">synthetic_metadata</span><span class="op">$</span><span class="va">response</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  x <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">synthetic_rnaseqData</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  modifyX <span class="op">=</span> <span class="st">"multiDEGGs_filter"</span>,</span></span>
<span class="r-in"><span>  modifyX_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>keep_single_genes <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>                         nfilter <span class="op">=</span> <span class="fl">20</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  modifyX_useY <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  n_outer_folds <span class="op">=</span> <span class="fl">5</span>,</span></span>
<span class="r-in"><span>  n_inner_folds <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit.glmnet</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Nested cross-validation with glmnet</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> No filter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Modifier:  multiDEGGs_filter </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Outer loop:  5-fold CV</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Inner loop:  6-fold CV</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 100 observations, 14 predictors</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        alpha  lambda n.filter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fold 1   0.1 0.09686        7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fold 2   0.1 0.12757        7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fold 3   0.1 0.15570        7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fold 4   0.1 0.10091        7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fold 5   0.1 0.15698        7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Final parameters:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  lambda    alpha  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.07099  0.10000  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Final coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  (Intercept) TNF:TNFRSF1A    AKT2:MTOR   IL1B:IL1R2    FASLG:FAS TGFB3:TGFBR1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     1.808953    -0.188626    -0.113628     0.050012    -0.034766    -0.030783 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MAP2K2:MAPK3  FANCD2:FAN1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    -0.020656    -0.008568 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Result:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        RMSE     R.squared   Pearson.r^2           MAE   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     0.47925       0.05714       0.07489       0.44620   </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># fit a random forest model:</span></span></span>
<span class="r-in"><span><span class="va">fit.rf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/nestedcv/man/nestcv.train.html" class="external-link">nestcv.train</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  y <span class="op">=</span> <span class="va">synthetic_metadata</span><span class="op">$</span><span class="va">response</span>,</span></span>
<span class="r-in"><span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">synthetic_rnaseqData</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  method <span class="op">=</span> <span class="st">"rf"</span>,</span></span>
<span class="r-in"><span>  modifyX <span class="op">=</span> <span class="st">"multiDEGGs_filter"</span>,</span></span>
<span class="r-in"><span>  modifyX_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>keep_single_genes <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>                         nfilter <span class="op">=</span> <span class="fl">20</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  modifyX_useY <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  n_outer_folds <span class="op">=</span> <span class="fl">5</span>,</span></span>
<span class="r-in"><span>  n_inner_folds <span class="op">=</span> <span class="fl">6</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Fitting final model using CV on whole data</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Duration: 3.020885 secs</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">fit.rf</span><span class="op">$</span><span class="va">summary</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                Reference</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Predicted       Non_responder Responder</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Non_responder            58         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Responder                 0        41</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               AUC            Accuracy   Balanced accuracy   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            0.9992              0.9900              0.9881   </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Elisabetta Sciacca.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

